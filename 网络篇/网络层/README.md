## 概述
因为网络层是整个互联网的核心，因此应当让网络层尽可能简单。网络层向上只提供简单灵活的、无连接的、尽最大努力交互的数据报服务。
与 IP 协议配套使用的还有三个协议：

- `地址解析协议 `ARP（Address Resolution Protocol）
- `网际控制报文协议` ICMP（Internet Control Message Protocol）
- `网际组管理协议` IGMP（Internet Group Management Protocol）

**版本** : 有 **4（IPv4）**和 **6（IPv6）**两个值；

**首部长度 **: 占 4 位，因此最大值为 15。值为 1 表示的是 1 个 32 位字的长度，也就是 4 字节。因为固定部分长度为 20 字节，因此该值最小为 5。如果可选字段的长度不是 4 字节的整数倍，就用尾部的填充部分来填充。

**区分服务** : 用来获得更好的服务，一般情况下不使用。

**总长度 **: 包括首部长度和数据部分长度。

**生存时间** ：TTL，它的存在是为了防止无法交付的数据报在互联网中不断兜圈子。以路由器跳数为单位，当 TTL 为 0 时就丢弃数据报。

**协议 **：指出携带的数据应该上交给哪个协议进行处理，例如 ICMP、TCP、UDP 等。

**首部检验和** ：因为数据报每经过一个路由器，都要重新计算检验和，因此检验和不包含数据部分可以减少计算的工作量。

**标识** : 在数据报长度过长从而发生分片的情况下，相同数据报的不同分片具有相同的标识符。

**片偏移** : 和标识符一起，用于发生分片的情况。片偏移的单位为 8 字节。


## IP 地址编址方式
IP 地址的编址方式经历了三个历史阶段：

- **分类**
- **子网划分**
- **无分类**
### 1. 分类
由两部分组成，**网络号和主机号**，其中不同分类具有不同的网络号长度，并且是固定的。
```
IP 地址 ::= {< 网络号 >, < 主机号 >}
```
### 2. 子网划分
通过在主机号字段中拿一部分作为子网号，把两级 IP 地址划分为三级 IP 地址。
```
IP 地址 ::= {< 网络号 >, < 子网号 >, < 主机号 >}
```
要使用子网，必须配置子网掩码。一个 B 类地址的默认子网掩码为 255.255.0.0，如果 B 类地址的子网占两个比特，那么子网掩码为 11111111 11111111 11000000 00000000，也就是 255.255.192.0。

注意，外部网络看不到子网的存在。
### 3. 无分类
无分类编址 CIDR 消除了传统 A 类、B 类和 C 类地址以及划分子网的概念，使用网络前缀和主机号来对 IP 地址进行编码，网络前缀的长度可以根据需要变化。
```
IP 地址 ::= {< 网络前缀号 >, < 主机号 >}
```
`CIDR` 的记法上采用在 IP 地址后面加上网络前缀长度的方法，例如 `128.14.35.7/20` 表示前 20 位为网络前缀。

`CIDR `的地址掩码可以继续称为子网掩码，子网掩码首 1 长度为网络前缀的长度。

一个` CIDR` 地址块中有很多地址，一个 CIDR 表示的网络就可以表示原来的很多个网络，并且在路由表中只需要一个路由就可以代替原来的多个路由，减少了路由表项的数量。把这种通过使用网络前缀来减少路由表项的方式称为路由聚合，也称为 构成超网 。

## 地址解析协议 ARP
网络层实现主机之间的通信，而链路层实现具体每段链路之间的通信。因此在通信过程中，IP 数据报的源地址和目的地址始终不变，而 MAC 地址随着链路的改变而改变。

